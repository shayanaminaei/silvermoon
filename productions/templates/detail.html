{% extends 'base.html' %}
{% load static %}

{% block title %}{{ product.name }} - Ø³ÛŒÙ„ÙˆØ±ğŸŒ–{% endblock %}

{% block content %}


            <!-- breadcrumb__start -->
            <div class="breadcrumb">
                <div class="container">
                    <div class="row">
                        <div class="col-xl-12">
                            <div class="breadcrumb__title">
                                <h1>Ù…Ø­ØµÙˆÙ„</h1>
                                <ul>
                                    <li>
                                        <a href="{% url 'productions:landing_page' %}">Ø®Ø§Ù†Ù‡</a>
                                    </li>
                                    <li>
                                        <a href="{% url 'productions:product_list_by_category' product.category.slug %}">{{ product.category.category_name }}</a>
                                    </li>
                                    <li class="color__blue">
                                        {{ product.name }}
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
             <!-- breadcrumb__end -->



<!-- single__product__start -->
   <div class="single__product sp_top_50 sp_bottom_80">
    <div class="container">
        <div class="row">
            <div class="col-xl-6 col-lg-6 col-md-12">
                <div class="featurearea__details__img"dir="ltr" >

                    <div id="productCarousel" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-inner">
        {% for image in images %}
        <div class="carousel-item {% if forloop.first %}active{% endif %}">
            <img class="d-block w-100" src="{{ image.photo.url }}" alt="{{ image.name }}">
        </div>
        {% endfor %}
    </div>

    <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ÛŒ Ø¨Ø±Ø§ÛŒ Ø­Ø±Ú©Øª Ø¨ÛŒÙ† Ø§Ø³Ù„Ø§ÛŒØ¯Ù‡Ø§ -->
    <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Ù‚Ø¨Ù„ÛŒ</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Ø¨Ø¹Ø¯ÛŒ</span>
    </button>
</div>

{#                    <div class=" featurearea__thumb__img featurearea__thumb__img__slider__active slider__default__arrow" >#}
{#                        {% for image in images %}#}
{#                            <div class="featurearea__single__thumb__img">#}
{#                                <img class="thumbnail-image" src="{{ image.photo.url }}" data-large="{{ product.main_image.url }}" alt="ØªØµÙˆÛŒØ± Ú©ÙˆÚ†Ú© Ù…Ø­ØµÙˆÙ„">#}
{#                            </div>#}
{#                        {% endfor %}#}
{#                        </div>#}
{#                    </div>#}

                </div>
            </div>
            <div class="col-xl-6 col-lg-6 col-md-12">
                <div class="single__product__wrap">
                    <div class="single__product__heding">
                        <h2>{{ product.name }}</h2>
                    </div>
                    <div class="single__product__price">
                        <span>{{ product.price }} ØªÙˆÙ…Ø§Ù†</span>
{#                        <del>90,000 ØªÙˆÙ…Ø§Ù†</del>#}
{#                        <label>ØµØ±ÙÙ‡ Ø¬ÙˆÛŒÛŒ -25%</label>#}
                    </div>

                    <hr>


                    <div class="single__product__description">
                        <p>{{ product.specifications }}</p>
                        
                        </div>
                     
                        <div class="single__product__special__feature">


                            <ul>
                              <li class="product__variant__inventory">
                                <strong class="inventory__title">Ù…ÙˆØ¬ÙˆØ¯ÛŒ:</strong>
                                <span class="variant__inventory">
                                    {% if product.available %}
                                        <span class="text-success">Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª</span>
                                    {% else %}
                                         <span class="text-danger">Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯</span>
                                    {% endif %}
                                </span>
                              </li>
                              <li>
                                <strong>Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ:</strong>
                                <span>
                                  <a>{{ product.category }}</a>
                                </span>
                              </li>
                              <li>
                                <strong> Ø¨Ø±Ù†Ø¯:</strong>
                                <span>
                                  <a href="#">{{ product.brand }}</a>
                                </span>
                              </li>
                            </ul>
                       
                          </div>

                          <hr>
                    {% if product.available == True %}



                    {% comment %} add to cart {% endcomment %}


                    
{#                            <form id="add-cart" method="POST">#}
{#                                {% csrf_token %}#}
{##}
{#                                <!-- Ø§Ù†ØªØ®Ø§Ø¨ ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø§ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ + Ùˆ - -->#}
{#                                <div class="single__product__quantity">#}
{#                                    <div class="qty-container">#}
{#                                        <button class="qty-btn-minus btn-qty" type="button">-</button>#}
{#                                        <input type="text" name="{{ form.quantity.name }}" value="1" class="input-qty" id="product-quantity" inputmode="numeric">#}
{#                                        <button class="qty-btn-plus btn-qty" type="button">+</button>#}
{#                                    </div>#}
{#                                </div>#}
{##}
{#                                <!-- Ø§Ù†ØªØ®Ø§Ø¨ Ø±Ù†Ú¯ -->#}
{#                                <div class="form-group">#}
{#                                    <label for="{{ form.color.id_for_label }}">{{ form.color.label }}</label>#}
{#                                    {{ form.color }}#}
{#                                </div>#}
{##}
{#                                <br>#}
{##}
{#                                <!-- Ø¯Ú©Ù…Ù‡ Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ -->#}
{#                                <a class="default__button" href="#" id="submit-link">#}
{#                                    <i class="fas fa-shopping-cart"></i> Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯#}
{#                                </a>#}
{#                            </form>#}
{##}
{##}
{##}
{#                            <hr>#}                                
                        {% endif %}


                            {# Add to Cart Section #}
                            <div class="single__product__actions" style="margin: 20px 0;">
                                <form id="add-to-cart-form" method="POST">
                                    {% csrf_token %}
                                    
                                    <!-- Color Selection -->
                                    <div class="color-selection" style="margin-bottom: 15px; display: flex; align-items: center;">
                                        <label style="margin-right: 10px; font-weight: bold; padding-left: 20px;">&nbsp;&nbsp;&nbsp;&nbsp;Ø§Ù†ØªØ®Ø§Ø¨ Ø±Ù†Ú¯:</label>
                                        <div class="color-options" style="display: flex; gap: 10px;">
                                            {% for color in product.colors.all %}
                                                <label class="color-option" style="cursor: pointer;" title="{{ color.name }}">
                                                    <input type="radio" name="color" value="{{ color.id }}" style="display: none;" {% if forloop.first %}checked{% endif %}>
                                                    <span style="display: inline-block; width: 30px; height: 30px; border-radius: 50%; background-color: {% if color.name == 'Ù‚Ø±Ù…Ø²' or color.name == 'red' %}#ff0000{% elif color.name == 'Ø¢Ø¨ÛŒ' or color.name == 'blue' %}#0000ff{% elif color.name == 'Ø³Ø¨Ø²' or color.name == 'green' %}#00ff00{% elif color.name == 'Ø²Ø±Ø¯' or color.name == 'yellow' %}#ffff00{% elif color.name == 'Ø³ÙÛŒØ¯' or color.name == 'white' %}#ffffff{% elif color.name == 'Ø³ÛŒØ§Ù‡' or color.name == 'black' %}#000000{% elif color.name == 'ØµÙˆØ±ØªÛŒ' or color.name == 'pink' %}#ffc0cb{% elif color.name == 'Ø¨Ù†ÙØ´' or color.name == 'purple' %}#800080{% elif color.name == 'Ù†Ø§Ø±Ù†Ø¬ÛŒ' or color.name == 'orange' %}#ffa500{% elif color.name == 'Ù‚Ù‡ÙˆÙ‡â€ŒØ§ÛŒ' or color.name == 'brown' %}#a52a2a{% elif color.name == 'Ø·ÙˆØ³ÛŒ' or color.name == 'gray' %}#808080{% else %}#cccccc{% endif %}; border: 2px solid #ddd; position: relative; transition: all 0.3s ease;" title="{{ color.name }}">
                                                        <span class="checkmark" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-weight: bold;">âœ“</span>
                                                    </span>
                                                </label>
                                            {% endfor %}
                                        </div>
                                    </div>
                                    
                                    <!-- Quantity Selection -->
                                    <div class="quantity-selection" style="margin-bottom: 20px; display: flex; align-items: center;">
                                        <label style="font-weight: 600; margin-right: 10px; padding-left: 20px;">&nbsp;&nbsp;&nbsp;&nbsp;ØªØ¹Ø¯Ø§Ø¯:</label>
                                        <div class="quantity-controls" style="display: flex; align-items: center; gap: 10px;">
                                            <input type="number" name="quantity" value="1" min="1" max="50" class="qty-input" style="width: 60px; text-align: center; border: 2px solid #ddd; border-radius: 8px; padding: 5px; font-size: 14px; font-weight: 600;">
                                        </div>
                                    </div>
                                </form>
                                
                                <!-- Action Buttons Section -->
                                <div class="product-actions" style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 15px; margin-top: 25px;">
                                    <!-- Gift Cart Button -->
                                    <button type="button" class="gift-cart-btn action-btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 15px; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 12px; transition: all 0.3s ease; text-align: center; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); white-space: nowrap;">ğŸ Ø³Ø¨Ø¯ Ù‡Ø¯ÛŒÙ‡</button>
                                    
                                    <!-- Add to Cart Button -->
                                    <a href="http://127.0.0.1:8000/cart/" type="submit" form="add-to-cart-form" class="add-to-cart-btn action-btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 15px; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 12px; transition: all 0.3s ease; text-align: center; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); white-space: nowrap;">ğŸ›’ Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯</a>
                                    
                                    <!-- Add to Shop List Button -->
                                    {#<button type="button" class="add-to-shop-list-btn action-btn" data-product-id="{{ product.id }}" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 15px; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 12px; transition: all 0.3s ease; text-align: center; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); white-space: nowrap;">ğŸ“ Ù„ÛŒØ³Øª Ø®Ø±ÛŒØ¯</button>#}
                                    
                                    <!-- Direct Donation Button -->
                                    <a href="http://127.0.0.1:8000/donate/" class="donate-btn action-btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-decoration: none; padding: 12px 15px; border-radius: 12px; font-weight: 600; display: flex; align-items: center; justify-content: center; font-size: 12px; transition: all 0.3s ease; text-align: center; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); white-space: nowrap;">ğŸ’ Ú©Ù…Ú© Ù…Ø§Ù„ÛŒ Ù…Ø³ØªÙ‚ÛŒÙ…</a>
                                </div>
                            </div>

                            
                            </p>
{#                            <div class="single__return__menu">#}
{#                                <h6>Ø®Ù„Ø§ØµÙ‡ Ù‚ÙˆØ§Ù†ÛŒÙ† Ø¨Ø§Ø²Ú¯Ø´Øª</h6>#}
{#                                <ul>#}
{#                                    <li>Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ø¯Øª 30 Ø±ÙˆØ² Ù¾Ø°ÛŒØ±ÙØªÙ‡ Ù…ÛŒ Ø´ÙˆØ¯</li>#}
{#                                    <li>Ø§Ø±Ø³Ø§Ù„ Ø±Ø§ÛŒÚ¯Ø§Ù† Ø¨Ø±Ú¯Ø´Øª</li>#}
{#                                    <li>Ø¨Ø¯ÙˆÙ† Ù‡Ø²ÛŒÙ†Ù‡ Ø°Ø®ÛŒØ±Ù‡ Ø³Ø§Ø²ÛŒ Ù…Ø¬Ø¯Ø¯</li>#}
{#                                    <li>Ú©Ø§Ù„Ø§ÛŒ ÙØ±ÙˆØ´ Ù†Ù‡Ø§ÛŒÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</li>#}
{#                                </ul>#}
{#                            </div>#}


                            <div class="single__product__small__img">
                                <ul>
                                    <li>
                                        <img src="img/footer/footer__1.svg" alt="">
                                    </li>
                                    <li>
                                        <img src="img/footer/footer__2.svg" alt="">
                                    </li>
                                    <li>
                                        <img src="img/footer/footer__3.svg" alt="">
                                    </li>
                                    <li>
                                        <img src="img/footer/footer__4.svg" alt="">
                                    </li>
                                    <li>
                                        <img src="img/footer/footer__5.svg" alt="">
                                    </li>
                                    <li>
                                        <img src="img/footer/footer__6.svg" alt="">
                                    </li>
                                </ul>
                            </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- single__product__end -->

            <!-- contact__section__start  -->
            <div class="single__product__contact sp_bottom_80">
                <div class="container">
                    <div class="row">
                        <div class="col-xl-12">
                            <div class="single__product__contact__text text-center">
                                <h2>Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø² Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ØªÙ…Ø§Ø³ Ø¨Ú¯ÛŒØ±ÛŒØ¯</h2>
                                <div class="single__product__contact__button">
                                <a href="{% url 'productions:contact' %}" class="default__button"> ØªÙ…Ø§Ø³ Ø¨Ø§ Ù…Ø§</a>
                            </div>
                           <!-- <h3 class="single__product__contact__number"><i class="fas fa-phone"></i> 09102052440</h3>
                            </div>-->
                        </div>
                    </div>
                </div>
            </div>
            <!-- contact__section__end  -->



{% endblock content %}

{% block extra_js %}
<script>
$(document).ready(function () {
    // Color selection functionality
    $('.color-option input[type="radio"]').change(function() {
        $('.color-option .checkmark').hide();
        $(this).siblings('.checkmark').show();
        $(this).parent().siblings().find('span').css('border', '2px solid #ddd');
        $(this).siblings('span').css('border', '2px solid #007bff');
    });

    // Initialize first color as selected
    $('.color-option:first input[type="radio"]').trigger('change');

    // Quantity control buttons
    $('.qty-plus').click(function() {
        const input = $('.qty-input');
        const currentValue = parseInt(input.val()) || 1;
        if (currentValue < 50) {
            input.val(currentValue + 1);
        }
    });

    $('.qty-minus').click(function() {
        const input = $('.qty-input');
        const currentValue = parseInt(input.val()) || 1;
        if (currentValue > 1) {
            input.val(currentValue - 1);
        }
    });

    // Validate quantity input
    $('.qty-input').on('input', function() {
        let value = parseInt($(this).val()) || 1;
        if (value < 1) value = 1;
        if (value > 50) value = 50;
        $(this).val(value);
    });

    // Add to cart form submission
    $('#add-to-cart-form').submit(function(e) {
        e.preventDefault();
        
        const formData = {
            'quantity': $('.qty-input').val(),
            'color': $('input[name="color"]:checked').val(),
            'csrfmiddlewaretoken': $('[name=csrfmiddlewaretoken]').val()
        };

        // Show loading state
        const submitBtn = $('.add-to-cart-btn');
        const originalText = submitBtn.html();
        submitBtn.html('ğŸ”„ Ø¯Ø± Ø­Ø§Ù„ Ø§ÙØ²ÙˆØ¯Ù†...').prop('disabled', true);

        $.ajax({
            type: 'POST',
            url: '{% url "orders:cart_add" product.id %}',
            data: formData,
            success: function(response) {
                submitBtn.html('âœ… Ø§ÙØ²ÙˆØ¯Ù‡ Ø´Ø¯!').css('background', '#28a745');
                setTimeout(function() {
                    submitBtn.html(originalText).css('background', 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)').prop('disabled', false);
                }, 2000);
                
                // Show success message and redirect to cart
                alert('Ù…Ø­ØµÙˆÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯!');
                // Redirect to cart page
                window.location.href = 'http://127.0.0.1:8000/cart/';
            },
            error: function(xhr, status, error) {
                submitBtn.html(originalText).prop('disabled', false);
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯:', error);
                alert('Ø®Ø·Ø§ Ø¯Ø± Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯!');
            }
        });
    });

    // Add to Shop List functionality
    $('.add-to-shop-list-btn').click(function(e) {
        e.preventDefault();
        
        const productId = $(this).data('product-id');
        const button = $(this);
        const originalText = button.html();
        
        // Show loading state
        button.html('ğŸ”„ Ø¯Ø± Ø­Ø§Ù„ Ø§ÙØ²ÙˆØ¯Ù†...').prop('disabled', true);
        
        $.ajax({
            type: 'POST',
            url: '{% url "productions:add_to_shop_list" 0 %}'.replace('0', productId),
            headers: {
                'X-CSRFToken': $('[name=csrfmiddlewaretoken]').val()
            },
            success: function(response) {
                if (response.success) {
                    button.html('âœ… Ø§ÙØ²ÙˆØ¯Ù‡ Ø´Ø¯!').css('background', '#28a745');
                    setTimeout(function() {
                        button.html(originalText).css('background', 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)').prop('disabled', false);
                    }, 2000);
                    alert('Ù…Ø­ØµÙˆÙ„ Ø¨Ù‡ Ù„ÛŒØ³Øª Ø®Ø±ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯!');
                } else {
                    button.html('âš ï¸ Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª').css('background', '#ffc107');
                    setTimeout(function() {
                        button.html(originalText).css('background', 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)').prop('disabled', false);
                    }, 2000);
                    alert(response.message);
                }
            },
            error: function(xhr, status, error) {
                button.html(originalText).prop('disabled', false);
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ù„ÛŒØ³Øª Ø®Ø±ÛŒØ¯:', error);
                alert('Ø®Ø·Ø§ Ø¯Ø± Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ Ø¨Ù‡ Ù„ÛŒØ³Øª Ø®Ø±ÛŒØ¯!');
            }
        });
    });

    // Hover effects for buttons
    $('.add-to-cart-btn, .add-to-shop-list-btn').hover(
        function() {
            $(this).css('transform', 'translateY(-2px)');
        },
        function() {
            $(this).css('transform', 'translateY(0)');
        }
    );

    $('.view-cart-btn').hover(
        function() {
            $(this).css({
                'background': '#5a6268',
                'transform': 'translateY(-2px)'
            });
        },
        function() {
            $(this).css({
                'background': '#6c757d',
                'transform': 'translateY(0)'
            });
        }
    );
});
</script>
{% endblock %}
