{% extends 'base.html' %}
{% load static %}

{% block title %}{{ product.name }} - ÿ≥€åŸÑŸàÿ±üåñ{% endblock %}

{% block content %}


            <!-- breadcrumb__start -->
            <div class="breadcrumb">
                <div class="container">
                    <div class="row">
                        <div class="col-xl-12">
                            <div class="breadcrumb__title">
                                <h1>ŸÖÿ≠ÿµŸàŸÑ</h1>
                                <ul>
                                    <li>
                                        <a href="{% url 'productions:landing_page' %}">ÿÆÿßŸÜŸá</a>
                                    </li>
                                    <li>
                                        <a href="{% url 'productions:product_list_by_category' product.category.slug %}">{{ product.category.category_name }}</a>
                                    </li>
                                    <li class="color__blue">
                                        {{ product.name }}
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
             <!-- breadcrumb__end -->



<!-- single__product__start -->
   <div class="single__product sp_top_50 sp_bottom_80">
    <div class="container">
        <div class="row">
            <div class="col-xl-6 col-lg-6 col-md-12">
                <div class="featurearea__details__img"dir="ltr" >

                    <div id="productCarousel" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-inner">
        {% for image in images %}
        <div class="carousel-item {% if forloop.first %}active{% endif %}">
            <img class="d-block w-100" src="{{ image.photo.url }}" alt="{{ image.name }}">
        </div>
        {% endfor %}
    </div>

    <!-- ÿØ⁄©ŸÖŸá‚ÄåŸáÿß€å ⁄©ŸÜÿ™ÿ±ŸÑ€å ÿ®ÿ±ÿß€å ÿ≠ÿ±⁄©ÿ™ ÿ®€åŸÜ ÿßÿ≥ŸÑÿß€åÿØŸáÿß -->
    <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">ŸÇÿ®ŸÑ€å</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">ÿ®ÿπÿØ€å</span>
    </button>
</div>

{#                    <div class=" featurearea__thumb__img featurearea__thumb__img__slider__active slider__default__arrow" >#}
{#                        {% for image in images %}#}
{#                            <div class="featurearea__single__thumb__img">#}
{#                                <img class="thumbnail-image" src="{{ image.photo.url }}" data-large="{{ product.main_image.url }}" alt="ÿ™ÿµŸà€åÿ± ⁄©Ÿà⁄Ü⁄© ŸÖÿ≠ÿµŸàŸÑ">#}
{#                            </div>#}
{#                        {% endfor %}#}
{#                        </div>#}
{#                    </div>#}

                </div>
            </div>
            <div class="col-xl-6 col-lg-6 col-md-12">
                <div class="single__product__wrap">
                    <div class="single__product__heding">
                        <h2>{{ product.name }}</h2>
                    </div>
                    <div class="single__product__price">
                        <span>{{ product.price }} ÿ™ŸàŸÖÿßŸÜ</span>
{#                        <del>90,000 ÿ™ŸàŸÖÿßŸÜ</del>#}
{#                        <label>ÿµÿ±ŸÅŸá ÿ¨Ÿà€å€å -25%</label>#}
                    </div>

                    <hr>


                    <div class="single__product__description">
                        <p>{{ product.specifications }}</p>
                        
                        </div>
                     
                        <div class="single__product__special__feature">


                            <ul>
                              <li class="product__variant__inventory">
                                <strong class="inventory__title">ŸÖŸàÿ¨ŸàÿØ€å:</strong>
                                <span class="variant__inventory">
                                    {% if product.available %}
                                        <span class="text-success">ŸÖŸàÿ¨ŸàÿØ ÿßÿ≥ÿ™</span>
                                    {% else %}
                                         <span class="text-danger">ŸÜÿßŸÖŸàÿ¨ŸàÿØ</span>
                                    {% endif %}
                                </span>
                              </li>
                              <li>
                                <strong>ÿØÿ≥ÿ™Ÿá ÿ®ŸÜÿØ€å:</strong>
                                <span>
                                  <a>{{ product.category }}</a>
                                </span>
                              </li>
                              <li>
                                <strong> ÿ®ÿ±ŸÜÿØ:</strong>
                                <span>
                                  <a href="#">{{ product.brand }}</a>
                                </span>
                              </li>
                            </ul>
                       
                          </div>

                          <hr>
                    {% if product.available == True %}



                    {% comment %} add to cart {% endcomment %}


                    
{#                            <form id="add-cart" method="POST">#}
{#                                {% csrf_token %}#}
{##}
{#                                <!-- ÿßŸÜÿ™ÿÆÿßÿ® ÿ™ÿπÿØÿßÿØ ÿ®ÿß ÿØ⁄©ŸÖŸá‚ÄåŸáÿß€å + Ÿà - -->#}
{#                                <div class="single__product__quantity">#}
{#                                    <div class="qty-container">#}
{#                                        <button class="qty-btn-minus btn-qty" type="button">-</button>#}
{#                                        <input type="text" name="{{ form.quantity.name }}" value="1" class="input-qty" id="product-quantity" inputmode="numeric">#}
{#                                        <button class="qty-btn-plus btn-qty" type="button">+</button>#}
{#                                    </div>#}
{#                                </div>#}
{##}
{#                                <!-- ÿßŸÜÿ™ÿÆÿßÿ® ÿ±ŸÜ⁄Ø -->#}
{#                                <div class="form-group">#}
{#                                    <label for="{{ form.color.id_for_label }}">{{ form.color.label }}</label>#}
{#                                    {{ form.color }}#}
{#                                </div>#}
{##}
{#                                <br>#}
{##}
{#                                <!-- ÿØ⁄©ŸÖŸá ÿßŸÅÿ≤ŸàÿØŸÜ ÿ®Ÿá ÿ≥ÿ®ÿØ ÿÆÿ±€åÿØ -->#}
{#                                <a class="default__button" href="#" id="submit-link">#}
{#                                    <i class="fas fa-shopping-cart"></i> ÿßŸÅÿ≤ŸàÿØŸÜ ÿ®Ÿá ÿ≥ÿ®ÿØ ÿÆÿ±€åÿØ#}
{#                                </a>#}
{#                            </form>#}
{##}
{##}
{##}
{#                            <hr>#}                                
                        {% endif %}


                            {# Add to Cart Section #}
                            <div class="single__product__actions" style="margin: 20px 0;">
                                <form id="add-to-cart-form" method="POST">
                                    {% csrf_token %}
                                    
                                    <!-- Color Selection -->
                                    <div class="color-selection" style="margin-bottom: 15px; display: flex; align-items: center;">
                                        <label style="margin-right: 10px; font-weight: bold; padding-left: 20px;">&nbsp;&nbsp;&nbsp;&nbsp;ÿßŸÜÿ™ÿÆÿßÿ® ÿ±ŸÜ⁄Ø:</label>
                                        <div class="color-options" style="display: flex; gap: 10px;">
                                            {% for color in product.colors.all %}
                                                <label class="color-option" style="cursor: pointer;" title="{{ color.name }}">
                                                    <input type="radio" name="color" value="{{ color.id }}" style="display: none;" {% if forloop.first %}checked{% endif %}>
                                                    <span style="display: inline-block; width: 30px; height: 30px; border-radius: 50%; background-color: {% if color.name == 'ŸÇÿ±ŸÖÿ≤' or color.name == 'red' %}#ff0000{% elif color.name == 'ÿ¢ÿ®€å' or color.name == 'blue' %}#0000ff{% elif color.name == 'ÿ≥ÿ®ÿ≤' or color.name == 'green' %}#00ff00{% elif color.name == 'ÿ≤ÿ±ÿØ' or color.name == 'yellow' %}#ffff00{% elif color.name == 'ÿ≥ŸÅ€åÿØ' or color.name == 'white' %}#ffffff{% elif color.name == 'ÿ≥€åÿßŸá' or color.name == 'black' %}#000000{% elif color.name == 'ÿµŸàÿ±ÿ™€å' or color.name == 'pink' %}#ffc0cb{% elif color.name == 'ÿ®ŸÜŸÅÿ¥' or color.name == 'purple' %}#800080{% elif color.name == 'ŸÜÿßÿ±ŸÜÿ¨€å' or color.name == 'orange' %}#ffa500{% elif color.name == 'ŸÇŸáŸàŸá‚Äåÿß€å' or color.name == 'brown' %}#a52a2a{% elif color.name == 'ÿ∑Ÿàÿ≥€å' or color.name == 'gray' %}#808080{% else %}#cccccc{% endif %}; border: 2px solid #ddd; position: relative; transition: all 0.3s ease;" title="{{ color.name }}">
                                                        <span class="checkmark" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-weight: bold;">‚úì</span>
                                                    </span>
                                                </label>
                                            {% endfor %}
                                        </div>
                                    </div>
                                    
                                    <!-- Quantity Selection -->
                                    <div class="quantity-selection" style="margin-bottom: 20px; display: flex; align-items: center;">
                                        <label style="font-weight: 600; margin-right: 10px; padding-left: 20px;">&nbsp;&nbsp;&nbsp;&nbsp;ÿ™ÿπÿØÿßÿØ:</label>
                                        <div class="quantity-controls" style="display: flex; align-items: center; gap: 10px;">
                                            <input type="number" name="quantity" value="1" min="1" max="50" class="qty-input" style="width: 60px; text-align: center; border: 2px solid #ddd; border-radius: 8px; padding: 5px; font-size: 14px; font-weight: 600;">
                                        </div>
                                    </div>
                                </form>
                                
                                <!-- Action Buttons Section -->
                                <div class="product-actions" style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 15px; margin-top: 25px;">
                                    <!-- Gift Cart Button -->
                                    <button type="button" class="gift-cart-btn action-btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 15px; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 12px; transition: all 0.3s ease; text-align: center; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); white-space: nowrap;">üéÅ ÿ≥ÿ®ÿØ ŸáÿØ€åŸá</button>
                                    
                                    <!-- Add to Cart Button -->
                                    <a href="http://127.0.0.1:8000/cart/" type="submit" form="add-to-cart-form" class="add-to-cart-btn action-btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 15px; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 12px; transition: all 0.3s ease; text-align: center; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); white-space: nowrap;">üõí ÿßŸÅÿ≤ŸàÿØŸÜ ÿ®Ÿá ÿ≥ÿ®ÿØ ÿÆÿ±€åÿØ</a>
                                    
                                    <!-- Add to Shop List Button -->
                                    {#<button type="button" class="add-to-shop-list-btn action-btn" data-product-id="{{ product.id }}" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 15px; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 12px; transition: all 0.3s ease; text-align: center; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); white-space: nowrap;">üìù ŸÑ€åÿ≥ÿ™ ÿÆÿ±€åÿØ</button>#}
                                    
                                    <!-- Direct Donation Button -->
                                    <a href="http://127.0.0.1:8000/donate/" class="donate-btn action-btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-decoration: none; padding: 12px 15px; border-radius: 12px; font-weight: 600; display: flex; align-items: center; justify-content: center; font-size: 12px; transition: all 0.3s ease; text-align: center; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); white-space: nowrap;">üíù ⁄©ŸÖ⁄© ŸÖÿßŸÑ€å ŸÖÿ≥ÿ™ŸÇ€åŸÖ</a>
                                </div>
                            </div>

                            
                            </p>
{#                            <div class="single__return__menu">#}
{#                                <h6>ÿÆŸÑÿßÿµŸá ŸÇŸàÿßŸÜ€åŸÜ ÿ®ÿßÿ≤⁄Øÿ¥ÿ™</h6>#}
{#                                <ul>#}
{#                                    <li>ÿ®ÿßÿ≤⁄Øÿ¥ÿ™ ÿ®Ÿá ŸÖÿØÿ™ 30 ÿ±Ÿàÿ≤ Ÿæÿ∞€åÿ±ŸÅÿ™Ÿá ŸÖ€å ÿ¥ŸàÿØ</li>#}
{#                                    <li>ÿßÿ±ÿ≥ÿßŸÑ ÿ±ÿß€å⁄ØÿßŸÜ ÿ®ÿ±⁄Øÿ¥ÿ™</li>#}
{#                                    <li>ÿ®ÿØŸàŸÜ Ÿáÿ≤€åŸÜŸá ÿ∞ÿÆ€åÿ±Ÿá ÿ≥ÿßÿ≤€å ŸÖÿ¨ÿØÿØ</li>#}
{#                                    <li>⁄©ÿßŸÑÿß€å ŸÅÿ±Ÿàÿ¥ ŸÜŸáÿß€å€å Ÿàÿ¨ŸàÿØ ŸÜÿØÿßÿ±ÿØ</li>#}
{#                                </ul>#}
{#                            </div>#}


                            <div class="single__product__small__img">
                                <ul>
                                    <li>
                                        <img src="img/footer/footer__1.svg" alt="">
                                    </li>
                                    <li>
                                        <img src="img/footer/footer__2.svg" alt="">
                                    </li>
                                    <li>
                                        <img src="img/footer/footer__3.svg" alt="">
                                    </li>
                                    <li>
                                        <img src="img/footer/footer__4.svg" alt="">
                                    </li>
                                    <li>
                                        <img src="img/footer/footer__5.svg" alt="">
                                    </li>
                                    <li>
                                        <img src="img/footer/footer__6.svg" alt="">
                                    </li>
                                </ul>
                            </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- single__product__end -->

            <!-- contact__section__start  -->
            <div class="single__product__contact sp_bottom_80">
                <div class="container">
                    <div class="row">
                        <div class="col-xl-12">
                            <div class="single__product__contact__text text-center">
                                <h2>ÿØÿ± ÿµŸàÿ±ÿ™ ŸÜ€åÿßÿ≤ ÿ®ÿß Ÿæÿ¥ÿ™€åÿ®ÿßŸÜ€å ÿ™ŸÖÿßÿ≥ ÿ®⁄Ø€åÿ±€åÿØ</h2>
                                <div class="single__product__contact__button">
                                <a href="{% url 'productions:contact' %}" class="default__button"> ÿ™ŸÖÿßÿ≥ ÿ®ÿß ŸÖÿß</a>
                            </div>
                           <!-- <h3 class="single__product__contact__number"><i class="fas fa-phone"></i> 09102052440</h3>
                            </div>-->
                        </div>
                    </div>
                </div>
            </div>
            <!-- contact__section__end  -->



{% endblock content %}

{% block extra_js %}
<script>
$(document).ready(function () {
    // Color selection functionality
    $('.color-option input[type="radio"]').change(function() {
        $('.color-option .checkmark').hide();
        $(this).siblings('.checkmark').show();
        $(this).parent().siblings().find('span').css('border', '2px solid #ddd');
        $(this).siblings('span').css('border', '2px solid #007bff');
    });

    // Initialize first color as selected
    $('.color-option:first input[type="radio"]').trigger('change');

    // Quantity control buttons
    $('.qty-plus').click(function() {
        const input = $('.qty-input');
        const currentValue = parseInt(input.val()) || 1;
        if (currentValue < 50) {
            input.val(currentValue + 1);
        }
    });

    $('.qty-minus').click(function() {
        const input = $('.qty-input');
        const currentValue = parseInt(input.val()) || 1;
        if (currentValue > 1) {
            input.val(currentValue - 1);
        }
    });

    // Validate quantity input
    $('.qty-input').on('input', function() {
        let value = parseInt($(this).val()) || 1;
        if (value < 1) value = 1;
        if (value > 50) value = 50;
        $(this).val(value);
    });

    // Add to cart form submission
    $('#add-to-cart-form').submit(function(e) {
        e.preventDefault();
        
        const formData = {
            'quantity': $('.qty-input').val(),
            'color': $('input[name="color"]:checked').val(),
            'csrfmiddlewaretoken': $('[name=csrfmiddlewaretoken]').val()
        };

        // Show loading state
        const submitBtn = $('.add-to-cart-btn');
        const originalText = submitBtn.html();
        submitBtn.html('üîÑ ÿØÿ± ÿ≠ÿßŸÑ ÿßŸÅÿ≤ŸàÿØŸÜ...').prop('disabled', true);

        $.ajax({
            type: 'POST',
            url: '{% url "orders:cart_add" product.id %}',
            data: formData,
            success: function(response) {
                submitBtn.html('‚úÖ ÿßŸÅÿ≤ŸàÿØŸá ÿ¥ÿØ!').css('background', '#28a745');
                setTimeout(function() {
                    submitBtn.html(originalText).css('background', 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)').prop('disabled', false);
                }, 2000);
                
                // Show success message and redirect to cart
                alert('ŸÖÿ≠ÿµŸàŸÑ ÿ®ÿß ŸÖŸàŸÅŸÇ€åÿ™ ÿ®Ÿá ÿ≥ÿ®ÿØ ÿÆÿ±€åÿØ ÿßÿ∂ÿßŸÅŸá ÿ¥ÿØ!');
                // Redirect to cart page
                window.location.href = 'http://127.0.0.1:8000/cart/';
            },
            error: function(xhr, status, error) {
                submitBtn.html(originalText).prop('disabled', false);
                console.error('ÿÆÿ∑ÿß ÿØÿ± ÿßŸÅÿ≤ŸàÿØŸÜ ÿ®Ÿá ÿ≥ÿ®ÿØ ÿÆÿ±€åÿØ:', error);
                alert('ÿÆÿ∑ÿß ÿØÿ± ÿßŸÅÿ≤ŸàÿØŸÜ ŸÖÿ≠ÿµŸàŸÑ ÿ®Ÿá ÿ≥ÿ®ÿØ ÿÆÿ±€åÿØ!');
            }
        });
    });

    // Add to Shop List functionality
    $('.add-to-shop-list-btn').click(function(e) {
        e.preventDefault();
        
        const productId = $(this).data('product-id');
        const button = $(this);
        const originalText = button.html();
        
        // Show loading state
        button.html('üîÑ ÿØÿ± ÿ≠ÿßŸÑ ÿßŸÅÿ≤ŸàÿØŸÜ...').prop('disabled', true);
        
        $.ajax({
            type: 'POST',
            url: '{% url "productions:add_to_shop_list" 0 %}'.replace('0', productId),
            headers: {
                'X-CSRFToken': $('[name=csrfmiddlewaretoken]').val()
            },
            success: function(response) {
                if (response.success) {
                    button.html('‚úÖ ÿßŸÅÿ≤ŸàÿØŸá ÿ¥ÿØ!').css('background', '#28a745');
                    setTimeout(function() {
                        button.html(originalText).css('background', 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)').prop('disabled', false);
                    }, 2000);
                    alert('ŸÖÿ≠ÿµŸàŸÑ ÿ®Ÿá ŸÑ€åÿ≥ÿ™ ÿÆÿ±€åÿØ ÿßÿ∂ÿßŸÅŸá ÿ¥ÿØ!');
                } else {
                    button.html('‚ö†Ô∏è ŸÖŸàÿ¨ŸàÿØ ÿßÿ≥ÿ™').css('background', '#ffc107');
                    setTimeout(function() {
                        button.html(originalText).css('background', 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)').prop('disabled', false);
                    }, 2000);
                    alert(response.message);
                }
            },
            error: function(xhr, status, error) {
                button.html(originalText).prop('disabled', false);
                console.error('ÿÆÿ∑ÿß ÿØÿ± ÿßŸÅÿ≤ŸàÿØŸÜ ÿ®Ÿá ŸÑ€åÿ≥ÿ™ ÿÆÿ±€åÿØ:', error);
                alert('ÿÆÿ∑ÿß ÿØÿ± ÿßŸÅÿ≤ŸàÿØŸÜ ŸÖÿ≠ÿµŸàŸÑ ÿ®Ÿá ŸÑ€åÿ≥ÿ™ ÿÆÿ±€åÿØ!');
            }
        });
    });

    // Hover effects for buttons
    $('.add-to-cart-btn, .add-to-shop-list-btn').hover(
        function() {
            $(this).css('transform', 'translateY(-2px)');
        },
        function() {
            $(this).css('transform', 'translateY(0)');
        }
    );

    $('.view-cart-btn').hover(
        function() {
            $(this).css({
                'background': '#5a6268',
                'transform': 'translateY(-2px)'
            });
        },
        function() {
            $(this).css({
                'background': '#6c757d',
                'transform': 'translateY(0)'
            });
        }
    );
});
</script>
{% endblock %}
